#Genome assemblies 

### Flye assembly command for nanopore and pacbio
flye --nano-hq ./pacbio_reads/m64047_220322_210536.ccs.fastq.gz ./pacbio_reads/m64047_220522_063338.ccs.fastq.gz ./pacbio_reads/m64047_210924_101806.ccs.fastq.gz ./nanopore_reads/basecalling_ligationseq/pass/combined.fastq ./nanopore_reads/basecalling_ligationseq2/pass/combined2.fastq --out-dir whelk_genome_flye_nanopac_08282022 --threads 100

### Smartdenovo assembly commands for nanopore and pacbio data
smartdenovo.pl -t 60 -p pb1 -c 1 ./combinedlrseq.fa.gz > smartdenovo_assembly_nanopac_09012022.mak
make -f ./smartdenovo_assembly_nanopac_09012022.mak

### Spades assembly commands for illumina novaseq data
spades.py --pe1-1 ./genome/novaseq_reads/R1_paired.fastq --pe1-2 ./genome/novaseq_reads/R2_paired.fastq \
-t 100 -m 900 -o ./genome/spades_assembly_12022022


### ABySS assembly commands for illumina novaseq data
abyss-pe name=abyss_genome_(date) j=60 k=80 B=500G in='./genome/novaseq_reads/R1_paired.fastq ./genome/novaseq_reads/R2_paired.fastq'

### MaSuRCA assembly config file and command for Illumina Nanopore and Pacbio Data (long read data in combinedlrseq.fa.gz)
# need bzip2, numactl, and boost to run Masurca - will end in error during pre correction of long reads if absent

conda install -c anaconda bzip2
conda install -c brown-data-science numactl
conda install -c conda-forge boost

# uploaded MaSuRCA4.0.9 directly and created config file 
# config.txt 
# configuration file (10/04/2022)
DATA
PE = pe 500 50 /large/whelk/genome/novaseq_reads/R1_paired.fastq.gz /large/whelk/genome/novaseq_reads/R2_paired.fastq.gz
NANOPORE = /large/whelk/genome/combinedlrseq.fa.gz
END
PARAMETERS
EXTEND_JUMP_READS=0
GRAPH_KMER_SIZE = auto
USE_LINKING_MATES = 0
USE_GRID=0
GRID_ENGINE=SGE
GRID_QUEUE=all.q
GRID_BATCH_SIZE=500000000
LHE_COVERAGE=25
LIMIT_JUMP_COVERAGE = 300
CA_PARAMETERS =  cgwErrorRate=0.15
CLOSE_GAPS=1
NUM_THREADS = 64
JF_SIZE = 74000000000
SOAP_ASSEMBLY=0
FLYE_ASSEMBLY=1
END

# command for Masurca assembly
./MaSuRCA-4.0.9/bin/masurca ./masurca_assembly_10042022/config.txt

./assemble.sh

# assembly restart by runing both commands again (creates new assemble.sh based on what files have already be constructed): 
./MaSuRCA-4.0.9/bin/masurca ./masurca_assembly_10042022/config.txt

./assemble.sh 


### Command for Flye assembly using Masurca super_reads and masurca corrected long read data (pacbio and nanopore) 
# this was conducted due to a bug error in Masurca output - assembly is consistent with/the same as Masurca output
flye --pacbio-corr /large/whelk/genome/masurca_assembly_10292022/mr.99.17.15.0.02.1.fa /large/whelk/genome/masurca_assembly_10292022/work1/superReadSequences.fasta --out-dir whelk_genome_flye_hack_11232022 --genome-size 2.4g --threads 60


